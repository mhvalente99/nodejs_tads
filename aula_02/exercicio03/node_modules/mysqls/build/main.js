"use strict";var _regenerator=require("babel-runtime/regenerator"),_regenerator2=_interopRequireDefault(_regenerator),_promise=require("babel-runtime/core-js/promise"),_promise2=_interopRequireDefault(_promise),_asyncToGenerator2=require("babel-runtime/helpers/asyncToGenerator"),_asyncToGenerator3=_interopRequireDefault(_asyncToGenerator2),_assign=require("babel-runtime/core-js/object/assign"),_assign2=_interopRequireDefault(_assign),execute=function(){var e=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function e(){var r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=arguments[1];return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new _promise2.default(function(t,a){var e=require("mysql").createConnection(r);e.connect(),e.query(n,function(e,r,n){e?a(e):t(r)}),e.end()}));case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),query=function(){var n=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function e(r,n){return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new _promise2.default(function(t,a){r.query(n,function(e,r,n){e?a(e):t(r)})}));case 1:case"end":return e.stop()}},e,this)}));return function(e,r){return n.apply(this,arguments)}}(),transaction=function(){var e=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function e(){var s=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},l=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(l||l.length){e.next=2;break}return e.abrupt("return");case 2:return e.abrupt("return",new _promise2.default(function(){var n=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function e(r,n){var t,a,u,o,c,i;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=require("mysql"),(a=t.createConnection(s)).connect(),e.next=5,query(a,"start transaction;");case 5:u=[],o=0,c=l.length;case 7:if(!(o<c)){e.next=25;break}return e.prev=8,e.next=11,query(a,l[o]);case 11:i=e.sent,u.push(i),e.next=22;break;case 15:return e.prev=15,e.t0=e.catch(8),e.next=19,query(a,"rollback;");case 19:return a.end(),n(e.t0),e.abrupt("return");case 22:o++,e.next=7;break;case 25:if(u.length!=l.length){e.next=32;break}return e.next=28,query(a,"commit;");case 28:a.end(),r(u),e.next=36;break;case 32:return e.next=34,query(a,"rollback;");case 34:a.end(),n(u);case 36:case"end":return e.stop()}},e,this,[[8,15]])}));return function(e,r){return n.apply(this,arguments)}}()));case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),_common=require("./common"),common=_interopRequireWildcard(_common),_curd=require("./curd"),curd=_interopRequireWildcard(_curd);function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r.default=e,r}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var sqljson=(0,_assign2.default)({},common,curd);function mysql(){this.sqlObj={}}for(var key in sqljson)mysql.prototype[key]=sqljson[key];module.exports={execute:execute,transaction:transaction,sql:new mysql};